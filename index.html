<html>
  <head>
    <script src="https://unpkg.com/aframe@1.3.0"></script>
    <script src="components/core.js"></script>
    <script src="components/player.js"></script>
    <script src="components/collider-check.js"></script>
    <script src="components/obstacles.js"></script>
    <script src="components/moving-grid.js"></script>
    <script>
      const play = () => {
        window.removeEventListener("click", play);
        window.removeEventListener("touchstart", play);
        document.querySelectorAll("video, audio").forEach((el) => el.play());
        document
          .querySelectorAll("[sound],a-sound")
          .forEach((el) => el.components.sound.playSound());
      };
      window.addEventListener("click", play);
      window.addEventListener("touchstart", play);
    </script>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <button
      class="button-connect"
      style="
        z-index: 1;
        position: relative;
        background-color: transparent;
        color: turquoise;
        border: 1px solid turquoise;
        border-radius: 3px;
        margin: 4px;
        padding: 4px 8px;
        cursor: pointer;
      "
    >
      Connect ⚡️
    </button>
    <div id="speed">SPEED:</div>
    <a-scene
      id="scene-game"
      vr-mode-ui="false"
      fog="type: linear; color: black; near: 200; far: 250"
      background="color: black"
    >
      <a-entity core></a-entity>
      <a-entity obstacles></a-entity>
      <a-assets>
        <audio
          id="music"
          src="assets/sounds/horizon.mp3"
          autoplay
          loop
          preload
          crossorigin="anonymous"
        ></audio>
        <a-asset-item id="duck" src="assets/models/duck.obj"></a-asset-item>
        <a-asset-item id="duck-mtl" src="assets/models/duck.mtl"></a-asset-item>
        <a-asset-item
          id="duck-wire"
          src="assets/models/duck_wireframe.obj"
        ></a-asset-item>
        <a-asset-item
          id="duck-wire-mtl"
          src="assets/models/duck_wireframe.mtl"
        ></a-asset-item>
      </a-assets>
      <a-entity camera position="0 10 50"></a-entity>
      <a-sound src="#music"></a-sound>
      <a-entity moving-grid position="0 0 -60"></a-entity>
      <a-entity player collider-check position="0 0.5 30">
        <a-entity
          raycaster="objects: .collidable; far: 4; showLine: true"
          position="2 2 2"
        ></a-entity>
        <a-entity
          raycaster="objects: .collidable; far: 4; showLine: true"
          position="-2 2 2"
        ></a-entity>
        <a-entity
          scale="4 4 4"
          animation="property: rotation; dir: normal; dur: 1500; loop: true; easing: linear; to: 0 360 0;"
        >
          <a-obj-model
            id="duck-inside"
            src="#duck"
            mtl="#duck-mtl"
            light="type: hemisphere; color: #e9ff70; groundColor: #3C3; intensity: 6"
          ></a-obj-model>
          <a-obj-model
            id="duck-outside"
            src="#duck-wire"
            mtl="#duck-wire-mtl"
          ></a-obj-model>
        </a-entity>
      </a-entity>
      <a-text
        id="screamText"
        value="Scream if you wanna go faster"
        position="0 15 40"
        scale="4 4 4"
        color="#ff41bf"
        align="center"
        font="assets/fonts/Electrolize-Regular-msdf.json"
        font-image="assets/fonts/Electrolize-Regular.png"
        negate="false"
        opacity="0"
        animation__fadein="property: text.opacity; from: 0; to: 1; delay: 5000"
        animation__fadeout="property: text.opacity; from: 1; to: 0; delay: 8000"
      >
      </a-text>
      <a-text
        id="louderText"
        value="Louder!"
        position="0 16 40"
        scale="4 4 4"
        color="#ff41bf"
        align="center"
        font="assets/fonts/Electrolize-Regular-msdf.json"
        font-image="assets/fonts/Electrolize-Regular.png"
        negate="false"
        opacity="0"
      >
      </a-text>
      <a-text
        id="yeahText"
        value="YEEEAAH!!!"
        position="0 17 40"
        scale="4 4 4"
        color="#ff41bf"
        align="center"
        font="assets/fonts/Electrolize-Regular-msdf.json"
        font-image="assets/fonts/Electrolize-Regular.png"
        negate="false"
        opacity="0"
      >
      </a-text>
    </a-scene>
  </body>
</html>
